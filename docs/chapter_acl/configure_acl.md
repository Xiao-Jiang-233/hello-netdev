---
comments: true
---
# 配置 ACL

## 配置命令

**acl** [ **number** ] *acl-number* : 创建一个编号型ACL，并进入ACL视图。

| 参数         | 参数说明                           | 取值                                                                                   |
| ------------ | ---------------------------------- | -------------------------------------------------------------------------------------- |
| **number**   | 指定由数字标识的一个访问控制列表。 |                                                                                        |
| *acl-number* | 指定访问控制列表的编号。           | 整数形式，<br><li>2000～2999表示基本ACL范围。</li><li>3000～3999表示高级ACL范围。</li> |

### 基本 ACL 视图

**rule** [ *rule-id* ] { **deny** | **permit** } [ **source** { *source-address* *source-wildcard* | **any** } ] * : 配置基本ACL的规则。

| 参数                                                         | 参数说明                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | 取值                                                                                                                                                                                                                                                                                                                                                                        |
| ------------------------------------------------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| *rule-id*                                                    | 指定ACL的规则ID。<li>如果指定ID的规则已经存在，则会在旧规则的基础上叠加新定义的规则，相当于编辑一个已经存在的规则；如果指定ID的规则不存在，则使用指定的ID创建一个新规则，并且按照ID的大小决定规则插入的位置</li><li>如果不指定ID，则增加一个新规则时设备自动会为这个规则分配一个ID，ID按照大小排序。系统自动分配ID时会留有一定的空间，具体的相邻ID范围由step命令指定。</li><blockquote>设备自动生成的规则ID从步长值起始，缺省步长为5，即从5开始并按照5的倍数生成规则序号，序号分别为5、10、15、……</blockquote> | 整数形式，取值范围是0～4294967294。                                                                                                                                                                                                                                                                                                                                         |
| **deny**                                                     | 指定拒绝符合条件的报文。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |                                                                                                                                                                                                                                                                                                                                                                             |
| **permit**                                                   | 指定允许符合条件的报文。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |                                                                                                                                                                                                                                                                                                                                                                             |
| **source** { *source-address* *source-wildcard* \| **any** } | 指定ACL规则匹配报文的源地址信息。如果不配置，表示报文的任何源地址都匹配。其中：<li>*source-address* ：指定报文的源地址。</li><li>*source-wildcard* ：指定源地址通配符。</li><li>**any** ：表示报文的任意源地址。相当于 *source-address* 为0.0.0.0或者 *source-wildcard* 为255.255.255.255。</li>                                                                                                                                                                                                               | *source-address* 为点分十进制形式。<br> *source-wildcard* 为点分十进制形式。源地址通配符可以为0，相当于0.0.0.0，表示源地址为主机地址。 <blockquote>通配符，点分十进制格式，换算成二进制后，“0”表示“匹配”，“1”表示“不关心”，另外二进制中的1或者0可以不连续。比如，IP地址192.168.1.169、通配符0.0.0.172表示的网址为192.168.1.x0x0xx01，其中x可以是0，也可以是1。</blockquote> |

### 高级 ACL 视图

当版本类型为IPv4或ICMP时，高级访问控制列表的命令格式为：

**rule** [ *rule-id* ] { **deny** | **permit** } { **ip** | **icmp** } [ **destination** { *destination-address* *destination-wildcard* | **any** } | **source** { *source-address* *source-wildcard* | **any** } ] *

当协议类型为TCP或者UDP时，高级访问控制列表的命令格式为：

**rule** [ *rule-id* ] { **deny** | **permit** } { **tcp** | **udp** } [ **destination** { destination-address destination-wildcard | **any** } | destination-port { eq port | gt port | lt port | range port-start port-end | port-set port-set-name } | **source** { *source-address* source-wildcard | **any** } ] *

| 参数                                                                        | 参数说明                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | 取值                                                                                                                                                                                                                                                                                                                                                                        |
| --------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| *rule-id*                                                                   | 指定ACL的规则ID。<li>如果指定ID的规则已经存在，则会在旧规则的基础上叠加新定义的规则，相当于编辑一个已经存在的规则；如果指定ID的规则不存在，则使用指定的ID创建一个新规则，并且按照ID的大小决定规则插入的位置</li><li>如果不指定ID，则增加一个新规则时设备自动会为这个规则分配一个ID，ID按照大小排序。系统自动分配ID时会留有一定的空间，具体的相邻ID范围由step命令指定。</li><blockquote>设备自动生成的规则ID从步长值起始，缺省步长为5，即从5开始并按照5的倍数生成规则序号，序号分别为5、10、15、……</blockquote> | 整数形式，取值范围是0～4294967294。                                                                                                                                                                                                                                                                                                                                         |
| **deny**                                                                    | 指定拒绝符合条件的报文。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |                                                                                                                                                                                                                                                                                                                                                                             |
| **permit**                                                                  | 指定允许符合条件的报文。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |                                                                                                                                                                                                                                                                                                                                                                             |
| **icmp**                                                                    | 指定ACL规则匹配报文的协议类型为ICMP。                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |                                                                                                                                                                                                                                                                                                                                                                             |
| **tcp**                                                                     | 指定ACL规则匹配报文的协议类型为TCP。                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                             |
| **udp**                                                                     | 指定ACL规则匹配报文的协议类型为UDP。                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                             |
| **destination** { *destination-address* *destination-wildcard* \| **any** } |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| **source** { *source-address* *source-wildcard* \| **any** }                | 指定ACL规则匹配报文的源地址信息。如果不配置，表示报文的任何源地址都匹配。其中：<li>*source-address* ：指定报文的源地址。</li><li>*source-wildcard* ：指定源地址通配符。</li><li>**any** ：表示报文的任意源地址。相当于 *source-address* 为0.0.0.0或者 *source-wildcard* 为255.255.255.255。</li>                                                                                                                                                                                                               | *source-address* 为点分十进制形式。<br> *source-wildcard* 为点分十进制形式。源地址通配符可以为0，相当于0.0.0.0，表示源地址为主机地址。 <blockquote>通配符，点分十进制格式，换算成二进制后，“0”表示“匹配”，“1”表示“不关心”，另外二进制中的1或者0可以不连续。比如，IP地址192.168.1.169、通配符0.0.0.172表示的网址为192.168.1.x0x0xx01，其中x可以是0，也可以是1。</blockquote> |

## 注意事项

- 使用该命令配置后，ACL已经创建，即使退出该ACL视图，ACL列表一样存在，需要通过 **undo** **acl** *acl-number* 命令才能删除该ACL。
- 如果指定的 *rule-id* 已存在，且新规则与原规则存在冲突，则冲突的部分新规则代替原规则，相当于编辑一个已经存在的ACL的规则。
- 建议在编辑一个已存在 *rule-id* 的规则前，先将旧的规则删除，再创建新的规则，否则配置结果可能与预期的效果不同。

## 使用实例

配置基本ACL 2001

```text
<Huawei> system-view
[Huawei] acl 2001
[Huawei-acl-basic-2001] rule permit source 192.168.32.1 0 
                        # 允许源地址是192.168.32.1的报文通过。
```

配置高级ACL3001

```text
<Huawei> system-view
[Huawei] acl 3001
[Huawei-acl-adv-3001]rule permit ip source 10.9.0.0 0.0.255.255 destination 10.38.160.0 0.0.0.255
                    # 匹配从10.9.0.0网段的主机向10.38.160.0网段的主机发送的所有IP报文。
[Huawei-acl-adv-3001]rule permit tcp source 10.9.8.0 0.0.0.255 destination 10.38.160.0 0.0.0.255 destination-port eq web
                    # 匹配从10.9.8.0网段内的主机建立与10.38.160.0网段内的主机的web连接。
```
